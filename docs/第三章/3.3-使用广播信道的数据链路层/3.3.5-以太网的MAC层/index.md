# 3.3.5 以太网的MAC层

## MAC地址 ⭐ **选择题考点**

### 定义
- **MAC地址**：Media Access Control Address，媒体访问控制地址
- **长度**：**48位（6字节）** ⭐
- **格式**：通常用十六进制表示，如 `00-0C-29-1A-2B-3C`

### 特点
- **全球唯一**：每个适配器都有一个唯一的MAC地址
- **固化在适配器中**：MAC地址通常固化在网卡的ROM中
- **硬件地址**：也称为物理地址或硬件地址

### MAC地址的分配
- 前24位：组织唯一标识符（OUI），由IEEE分配
- 后24位：由厂家自行分配

## MAC帧的类型

### 单播帧（Unicast）
- **目的**：发送给单个站点
- **识别**：目的MAC地址为单播地址

### 广播帧（Broadcast）⭐
- **目的**：发送给所有站点
- **识别**：目的MAC地址为全1（`FF-FF-FF-FF-FF-FF`）⭐
- **十六进制表示**：`FF-FF-FF-FF-FF-FF`
- **二进制表示**：48位全为1

### 多播帧（Multicast）
- **目的**：发送给一组站点
- **识别**：目的MAC地址的第一位为1

## 以太网V2 MAC帧格式

### 帧结构
```
| 前同步码 | 目的地址 | 源地址 | 类型 | 数据 | FCS |
|  8字节  |  6字节   | 6字节 | 2字节| 46-1500字节 | 4字节 |
```

### 各字段说明

#### 前同步码（Preamble）
- **长度**：8字节
- **作用**：使接收端的适配器在接收MAC帧时能够迅速调整其时钟频率，使它和发送端的时钟同步
- **内容**：前7个字节为10101010，最后一个字节为10101011

#### 目的地址（Destination Address）
- **长度**：6字节
- **作用**：指明帧的接收站

#### 源地址（Source Address）
- **长度**：6字节
- **作用**：指明帧的发送站

#### 类型（Type）
- **长度**：2字节
- **作用**：用来标志上一层使用的是什么协议，以便把收到的MAC帧的数据上交给上一层的这个协议
- **常见值**：
  - 0x0800：IP协议
  - 0x0806：ARP协议
  - 0x8137：IPX协议
- **注意**：这是**以太网V2格式**的特征
  - **V2格式**：使用"类型"字段（标识上层协议）
  - **802.3格式**：使用"长度"字段（标识数据长度）
  - 考试中通常考查V2格式

#### 数据（Data）
- **长度**：46-1500字节
- **说明**：
  - 如果数据部分长度小于46字节，需要在数据部分后面加入填充字段
  - 最大长度为1500字节（MTU）

#### FCS（Frame Check Sequence）
- **长度**：4字节
- **作用**：帧检验序列，使用CRC检验

### 帧的最小长度 ⭐ **选择题考点**
- **最小长度**：**64字节**（不包括前同步码）⭐
- **组成**：目的地址(6) + 源地址(6) + 类型(2) + 数据(46) + FCS(4) = 64字节
- **原因**：确保在争用期内能够检测到碰撞
- **重要**：凡是长度小于64字节的帧都是无效帧（冲突帧），直接丢弃

### 帧的最大长度
- **最大长度**：1518字节（不包括前同步码）
- **组成**：目的地址(6) + 源地址(6) + 类型(2) + 数据(1500) + FCS(4) = 1518字节

### 前同步码说明
- **注意**：前同步码（8字节）是物理层添加的，**不属于MAC帧的部分**
- **作用**：用于时钟同步
- **计算帧长时**：通常不包含前同步码，只计算MAC帧本身（64-1518字节）

