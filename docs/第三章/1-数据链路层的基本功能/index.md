# 3.1 数据链路层的基本功能

本节旨在明确数据链路层在网络体系结构中的位置和作用，并介绍其核心概念，如链路、数据链路、点到点与端到端的区别，以及它为上层（网络层）提供的服务类型。

### 核心概念

#### 1. 链路与数据链路

*   **链路 (Link)**:
    *   定义：指从一个网络结点到相邻结点的**一段无源的物理线路**，中间不包含任何交换结点（如路由器或交换机）。
    *   可以理解为纯粹的物理连接介质。

*   **数据链路 (Data Link)**:
    *   定义：除了物理链路外，还必须有实现通信的**协议**来控制这些数据的传输。数据链路 = 链路 + 协议。
    *   数据链路层就是将原始的、可能出错的物理线路，改造成对网络层而言，逻辑上无差错的数据链路。

#### 2. 结点、点到点、端到端

*   **结点 (Node)**: 网络中的设备，如主机 (Host)、交换机 (Switch)、路由器 (Router) 等。
*   **点到点 (Point-to-point)**:
    *   指在**相邻两个结点**之间的一条链路上的通信。
    *   **数据链路层负责的就是点到点之间的通信**。
*   **端到端 (End-to-end)**:
    *   指从**源主机**到**目的主机**之间的通信。
    *   一个端到端的通信路径 (path) 可能由多条不同的链路组成。
    *   **传输层负责的是端到端的通信**。

#### 3. 为网络层提供的服务

数据链路层可以为网络层提供以下三种基本服务。它们的主要区别在于：**是否需要确认**、**是否需要建立连接**、**是否需要差错恢复**。

##### (1) 无确认的无连接服务 (Unacknowledged Connectionless Service)

*   **工作方式**: 
    *   数据链路层直接把数据帧发送给目标主机。
    *   发送方和接收方**不需要建立连接**，也**不需要确认**数据是否成功接收。
    *   每个数据帧都是独立的，发送方不会等待任何确认信号。
    
*   **差错处理**: 
    *   如果数据帧丢失（比如因为噪声干扰），数据链路层**不会**进行重传。
    *   差错恢复由更高层协议（如 TCP）来处理。
    
*   **适用场景**:
    *   **误码率极低的信道**（如有线局域网、以太网）。
    *   **实时通信**（如语音、视频传输）——在这类应用中，数据的**实时性比准确性更重要**，重传会引起延迟，是不可接受的。
    
*   **典型应用**: **绝大多数局域网 (LAN)** 都采用此服务，如以太网。
    
*   **优点**: 效率高，开销小，不需要过多的确认和控制。
*   **缺点**: 可靠性完全依赖于信道质量和上层协议。

##### (2) 有确认的无连接服务 (Acknowledged Connectionless Service)

*   **工作方式**: 
    *   发送方和接收方**不建立连接**。
    *   但发送的**每一帧都需要接收方单独确认** (ACK)。
    
*   **差错处理**: 
    *   发送方如果在**指定时间内未收到确认**，就会**重传**该数据帧。
    *   重传会持续进行，直到收到确认为止。
    
*   **适用场景**: 
    *   **误码率较高的不可靠信道**，如**无线通信 (Wi-Fi)**、蓝牙等。
    *   因为在这种情况下，丢帧和噪声干扰较为频繁，确认机制可以提高数据的可靠性。
    
*   **典型应用**: 无线网络（Wi-Fi）、蓝牙等无线通信。
    
*   **优点**: 在不可靠信道上提供较好的可靠性保障。
*   **缺点**: 需要确认机制，开销比无确认服务大。

##### (3) 有确认的面向连接的服务 (Acknowledged Connection-oriented Service)

*   **工作方式**: 这是**最可靠也最复杂**的服务。数据传输必须经过**三个阶段**：
    
    1.  **建立连接**: 
        *   发送方和接收方进行初始化。
        *   设置变量和计数器，为数据传输做准备。
        
    2.  **传输帧**: 
        *   所有帧都会被**编号**。
        *   接收方根据编号**按序接收**，并确认每一帧的接收。
        *   保证每个数据包都能被正确传输并按序到达。
        
    3.  **释放连接**: 
        *   数据传输完毕后，双方释放连接，回收资源。
    
*   **差错处理**: 
    *   提供强大的**差错检测与恢复**功能。
    *   确保每个数据包都能被正确传输并按序到达。
    
*   **适用场景**: 
    *   对**可靠性要求非常高**的场景。
    *   如金融交易、文件传输、专线网络等。
    *   在这些应用中，数据丢失或错误可能造成严重后果。
    
*   **典型应用**: ATM 网络、一些专线网络、高可靠性要求的通信协议。
    
*   **优点**: 可靠性最高，数据传输有保障。
*   **缺点**: 实现复杂，开销大，效率相对较低。

##### 三种服务的对比总结

| 特性 | 无确认无连接 | 有确认无连接 | 有确认面向连接 |
|:---|:---|:---|:---|
| **建立连接** | 否 | 否 | 是 |
| **确认机制** | 无 | 有（每帧单独确认） | 有（按序确认） |
| **差错恢复** | 不重传（由上层处理） | 重传丢失帧 | 完整的差错恢复 |
| **可靠性** | 低（依赖信道） | 中等 | 高 |
| **开销** | 最小 | 中等 | 最大 |
| **典型应用** | 以太网、有线局域网 | Wi-Fi、蓝牙 | ATM、专线网络 |
| **适用信道** | 误码率极低 | 误码率较高 | 对可靠性要求极高 |

### 易考点 & 难点

*   **易考点**:
    *   链路和数据链路的定义与区别（后者多了协议）。
    *   三种服务的名称和基本工作方式。
    *   知道以太网（大多数LAN）采用的是"无确认的无连接服务"。
*   **难点**:
    *   **深刻理解"点到点"与"端到端"的区别**。这是贯穿网络学习的一个核心概念。数据链路层只关心把一个帧从一个节点成功传到*下一个*节点，而不管最终目的地；传输层则关心把一个报文段从*源主机*的进程成功传到*目的主机*的进程。
