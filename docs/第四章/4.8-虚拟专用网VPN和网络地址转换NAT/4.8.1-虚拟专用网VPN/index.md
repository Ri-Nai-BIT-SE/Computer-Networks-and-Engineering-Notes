# 4.8.1 虚拟专用网 VPN (Virtual Private Network)

## 1. 背景与定义

*   **背景**：机构内部的主机需要通信，但全球 IP 地址紧缺，且互联网不安全。
*   **定义**：利用公用的互联网作为本机构各专用网之间的通信载体，这样的专用网称为虚拟专用网（VPN）。
    *   **"虚拟"**：表示没有使用真实的物理通信专线，而是通过公用网络建立逻辑上的"隧道"。
    *   **"专用"**：表示这些网络主要是为了机构内部通信，使用的是**专用 IP 地址**。

## 2. 专用地址 (Private IP Address)

RFC 1918 指明了一些**只能在机构内部使用**的 IP 地址，这些地址不能在互联网上路由（路由器遇到目的地址为专用地址的数据报会直接丢弃）。

| 类别 | 地址范围 | CIDR 表示 |
| :--- | :--- | :--- |
| **A 类** | `10.0.0.0` 到 `10.255.255.255` | `10.0.0.0/8` |
| **B 类** | `172.16.0.0` 到 `172.31.255.255` | `172.16.0.0/12` |
| **C 类** | `192.168.0.0` 到 `192.168.255.255` | `192.168.0.0/16` |

*   **本地地址 (Local Address)**：仅在机构内部有效的专用地址。
*   **全球地址 (Global Address)**：全球唯一的 IP 地址，必须向互联网管理机构申请。

## 3. 核心技术：隧道技术 (Tunneling)

VPN 的实现依赖于隧道技术。

*   **原理**：
    1.  机构内部的数据报（源/目的都是专用地址）在发送到互联网之前，被封装在一个新的 IP 数据报中。
    2.  新数据报的**源地址**和**目的地址**都是互联网上的**全球 IP 地址**（通常是 VPN 路由器的公网 IP）。
    3.  新数据报在互联网上传输，就像普通数据报一样。
    4.  到达目的地的 VPN 路由器后，解封取出原始的内部数据报，再转发给内部主机。
*   **安全性**：通常会对内部数据报进行加密，确保数据在公网传输时不被窃取。

## 4. VPN 的分类

1.  **内联网 VPN (Intranet VPN)**：由同一机构内部的局域网所构成的 VPN。
2.  **外联网 VPN (Extranet VPN)**：有时一个机构需要和某些外部机构（如合作伙伴）进行通信，将他们接入 VPN。
3.  **远程接入 VPN (Remote Access VPN)**：允许出差员工通过拨号或互联网接入公司内部网络。
